---
// This page handles OAuth callbacks from providers like Apple
---

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Authenticating...</title>
  <script>
         // Handle the OAuth callback
     const handleAuthCallback = async () => {
       try {
         const { supabase } = await import('/src/lib/supabase.js');
         
         if (supabase) {
           // Handle the auth callback
           const { data, error } = await supabase.auth.getSession();
           
           if (error) {
             console.error('Auth callback error:', error);
             window.location.href = '/?error=auth_failed';
           } else if (data.session) {
             // Successful authentication, redirect to dashboard
             window.location.href = '/';
           } else {
             // No session, redirect to login
             window.location.href = '/?error=no_session';
           }
         } else {
           window.location.href = '/?error=service_unavailable';
         }
       } catch (err) {
         console.error('Auth callback error:', err);
         window.location.href = '/?error=auth_failed';
       }
     };

    // Handle the callback when the page loads
    handleAuthCallback();
  </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen flex items-center justify-center">
  <div class="text-center">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
    <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Authenticating...</h2>
    <p class="text-gray-600 dark:text-gray-400">Please wait while we complete your sign-in.</p>
  </div>
</body>
</html>
